import{a as S}from"./chunk-DT7PBS4M.js";import{a as l}from"./chunk-RFNJKUZW.js";import{a as m}from"./chunk-RNDVJQN2.js";import{h as f}from"./chunk-A36NQ4WF.js";import{c as v,f as d,g as B}from"./chunk-TSZP6UXS.js";import{g as p}from"./chunk-NYGFFQMG.js";import{a as u}from"./chunk-NZY4JV6E.js";import{a as I,c as g}from"./chunk-3I3QPOUL.js";import{c as t}from"./chunk-4SRFE46V.js";import{q as C}from"./chunk-52XVUBCW.js";import{e as r}from"./chunk-3GYLW4KZ.js";var c=r(I()),i=r(C());var h=r(g());async function E(){let[e,n,a,o]=await Promise.all([m(),u(),f(),l()]);e&&(t.set("pageViewId",window.__wb_page_view_id),t.set("session",i.default.get(e,"session")),t.set("events",i.default.get(e,"settings.events")),t.set("settings",i.default.get(e,"settings")),t.set("tabId",i.default.get(e,"tabId"))),t.merge({siteAPIData:n}),t.merge({cashback:a}),t.set("lifetimeSavings",o)}async function L(e){await E();let n=t.get("siteAPIData"),a=n?.siteData?.cashback?.reward||{},o=await chrome.storage.local.get("lastCouponSavings"),s=o?.lastCouponSavings,P=t.get("cashback"),w=await p(e),_={rootEl:"div",logLevel:null},D={$savings:{couponSavings:s??0,cashbackActivated:!!P?.user?.activated,couponsActivated:s!=null},siteReward:a,couponSavings:o?.lastCouponSavings||0},b=await S();return{config:_,content:w,data:D,...b}}function k({contentSlug:e,onUnload:n}){let[a,o]=(0,c.useState)();return(0,c.useEffect)(()=>{L(e).then(s=>o(s)).catch(console.error)},[]),a?(0,h.jsx)(v,{config:a.config,content:a.content,host:a.host,user:a.user,data:a.data,onEvent:s=>d(s,n),onRequest:B}):null}export{k as a};
