import{a as v,b as k,g as q,h as V}from"../chunks/chunk-FIM3X34W.js";import"../chunks/chunk-3H2LF7G7.js";import"../chunks/chunk-ALJKGYUM.js";import{a as L}from"../chunks/chunk-6SB4OKRP.js";import{a as F}from"../chunks/chunk-G4GLYCCY.js";import{a as x}from"../chunks/chunk-RNDVJQN2.js";import{a as W,b}from"../chunks/chunk-3XIOB4EC.js";import{a as N,b as y}from"../chunks/chunk-VZ75JTZE.js";import{a as M}from"../chunks/chunk-NZY4JV6E.js";import"../chunks/chunk-3R2PURR4.js";import"../chunks/chunk-IQFNOK3G.js";import"../chunks/chunk-ZIQ6U6YW.js";import"../chunks/chunk-B7GBMFFD.js";import"../chunks/chunk-AKTW5CPL.js";import"../chunks/chunk-LLA7RVSB.js";import"../chunks/chunk-Z6PVZUDE.js";import"../chunks/chunk-FEK2HJKI.js";import"../chunks/chunk-NJ63VSGO.js";import"../chunks/chunk-OTRTIFBS.js";import"../chunks/chunk-MFYKHTND.js";import{I as R}from"../chunks/chunk-3I3QPOUL.js";import{a as z}from"../chunks/chunk-O4TFJKJQ.js";import{c as g,d as E,f as C,g as _,h as l,q as w,u as P}from"../chunks/chunk-4SRFE46V.js";import"../chunks/chunk-IJQWISPG.js";import"../chunks/chunk-HY2GWXPO.js";import"../chunks/chunk-LC5XJ32R.js";import"../chunks/chunk-6LTHT6DZ.js";import"../chunks/chunk-XSKOAVIS.js";import{q as O}from"../chunks/chunk-52XVUBCW.js";import{c as H}from"../chunks/chunk-42JNP4CL.js";import"../chunks/chunk-SOWOQI5E.js";import"../chunks/chunk-YCRAP75I.js";import"../chunks/chunk-JAUVA5AU.js";import{e as h}from"../chunks/chunk-3GYLW4KZ.js";var A=h(z()),a=h(O()),c=h(W());var s=h(O());H();var K=(e,r)=>w("deweyPriceComparisonWithoutNotif",{priceComparisonKey:e,product:r});var d,S,Y=250,U=2500;function j(e){return e.url}async function G(e){let r=e?.pageTypeBehaviors;if(r?.notifPlacementSelectors?.length||r?.deweyPCThreshold){let p=r?.notifPlacementSelectors||[],f=r?.deweyPCThreshold||U;return{runOptions:{input:{}},buttonOptions:p.length&&{insertAfterElement:p.map(({value:t})=>t)},priceThresholdCents:f}}let o=s.default.get(await k({domain:e?.domain}),"config",{}),i=o.CUT_OFF_PRICE_FOR_PRICE_RUN_IN_CENTS;return{...o,priceThresholdCents:i||U}}function J(e,r){return e.price?v(e.price,r,"disable_universal_price_run")?!1:{priceComparisonKey:j(e)}:!1}function $(e){try{S||(S=s.default.debounce(Q,Y)),S(e)}catch(r){}}async function Q(e){try{if(!(!L()&&l("dewey_price_comparison")&&s.default.get(e,"pageTypeBehaviors.deweyPC",!1))||s.default.get(e,"domain")==="amazon.com")return;let o=s.default.cloneDeep(s.default.get(e,"pageData.products[0]",{}));o.vendor=s.default.get(e,"domain"),o.price=o.list_price,o.mpn=o.manufacturer_number,delete o.list_price,delete o.manufacturer_number;let i=await G(e),p=J(o,i?.priceThresholdCents);if(!i||!i?.buttonOptions)return l("dewey_price_comparison_silent")&&p&&K(p.priceComparisonKey,o);if(!p){d="",R(q);return}let{priceComparisonKey:t}=p;if(t===d){`${t}`;return}`${t}`,d=t,E({active:!0}),i.runOptions.input.product=o;let n;s.default.forEach(i.buttonOptions.insertAfterElement,m=>{if(n=document.querySelector(m),n)return!1}),i.buttonOptions.insertAfterElement=n,s.default.set(i.runOptions.input,"meta.conquestOrigin",!0),s.default.set(i.runOptions.input,"meta.simpleOriginPricing",!0),s.default.set(i.runOptions.input,"deweyPC",!0),V({...i.buttonOptions,removeExistingApp:!0},{...i.runOptions,runCompleteCb:()=>{d&&d===t&&(d="",`${t}`,void 0)}})}catch(r){}}var B=e=>($(e),w("deweyResult",e));window.__wb_timing.deweyRequireAt=performance.now();async function X(){await Promise.all([x(),M()]).then(([e,r])=>{F(e),g.merge({siteAPIData:r})}),l("ext_instant_init_notifs")||document.readyState!=="loading"?T():document.addEventListener("DOMContentLoaded",T)}async function T(){let e=g.get("siteAPIData"),r=a.default.get(e,"tld");_(r),e=await Z(e)||e;let o=a.default.cloneDeep(e);o.document=document,o.document.deweyParser=A.default,o.document.html=document.documentElement.innerHTML,a.default.set(o,"siteData.tld",o.tld),y.setDefaultConfig(o);let i=l("log_all_dewey"),p=new Date,f=new Set(a.default.map(a.default.get(e,"siteData.tigger.coupons")||a.default.get(e,"siteData.roo.coupons")||[],"code"));y.emitter.on("result",async t=>{let n=await N(t);if(n.callSource==="internal"&&(g.set(["deweyResult"],n),B(n),n?.pageType||i)){let D=new Date-p,u=a.default.cloneDeep(n);u&&u.pageData&&u.pageData.meta&&(u.pageData.meta=[u.pageData.meta]),P("track","deweyResult",a.default.assign({},u,{url:window.location.href,flags:a.default.get(e,"siteData.flags"),logAllDewey:i,totalTimeElapsed:D,deweyAttempt:y.startAttempt}))}a.default.get(n,"pageData.coupons.length")&&a.default.forEach(n.pageData.coupons,m=>{f.has(m)||(P("track","codeApplied",{code:m,currentLocation:a.default.pick(window.location,["hash","host","hostname","href","origin","pathname","port","search"])}),f.add(m))})}),y.start()}async function Z(e){let r=a.default.get(e,"siteData.coupons.type"),o=await(0,c.getPlatform)({hasFeature:l,desktop:!0}),i=await b(C()),{separatePlatform:p,separatePlatformDomain:f}=(0,c.getSeparateCheckoutDomain)(C()),t=i?"Shopify":o||p,n=i||f||C();if(t&&n){_(n),g.set(["platform"],t),g.set(["platformDomain"],n),e=a.default.has(e,"siteData.tigger")?e:{...e,siteData:{...e.siteData,tigger:{}}},e.siteData.tigger[`${t.toLowerCase()}`]=!0,e.siteData.pageTypesV2=e.siteData.pageTypesV2||{};let{cartPage:m,checkoutPage:D,confirmationPage:u}=e.siteData.pageTypesV2;return new Set(["Magento","WooCommerce","BigCommerce","Squarespace"]).has(t)?(t==="Magento"&&(e.siteData.pageTypesV2.cartPage=m||(0,c.getSiteData)(t,"cartPage")),e.siteData.pageTypesV2.checkoutPage=D||(0,c.getSiteData)(t,"checkoutPage"),e.siteData.pageTypesV2.confirmationPage=u||(0,c.getSiteData)(t,"confirmationPage")):(e.siteData.pageTypesV2.checkoutPage=(0,c.getSiteData)(t,"checkoutPage"),e.siteData.pageTypesV2.confirmationPage=(0,c.getSiteData)(t,"confirmationPage")),(0,c.getSiteData)(t,"roo")&&r!=="roo"&&(e.siteData.roo=(0,c.getSiteData)(t,"roo")),e}}X();
